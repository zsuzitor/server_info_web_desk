@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
2 стандартный альбома нельзя удалять и делать их не первыми в бд
порядок в альбоме тоже лучше не менять(в 1 альбоме последняя фотка считается аватаркой)
названия должны быть без #

Session["NewMessageType"] = "1";
1- надо отправить сообщения
2-надо отправить колличество
3-надо отправить shortchat


ApplicationUser.GetUserId();
ApplicationUser user = ApplicationUser.GetUser(check_id);

ApplicationUser user = ApplicationUser.GetUser(ApplicationUser.GetUserId());
            if (user == null)
                return new HttpStatusCodeResult(404);


using (ApplicationDbContext db = new ApplicationDbContext())
db.Entry(user2).State = EntityState.Modified;
 db.Set<ApplicationUser>().Attach(this);
box-shadow: 0 0 10px rgba(0,0,0,0.5);
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

перенести это вниз
//css по файлам + для других браузеров префиксы
бандлы настроить
мб маршрутизацию
почитать тодо посомтреть мб что то еще
проверить using в контроллере
//кнопку загрузки офлайн версии
//описать что реализовано в ридми
//readme поправить





\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\





если открыть комменты на странице и комменты при клике на запись к 1 записи, возможно не будет работать или будет работать неправильно тк id блоков могут повторяться
js по файлам разделить
форму отправки ajax post мб в метод вынести
сейчас много разметки не убрано (border)
при работе в нескольких вкладках, скорее всего будет неправилньо отображаться online offline тк можно закрыть подключение с 1 вкладки и не подключиться к другой
возможно надо при каждом joinToHub подключать пользователя независимо от того есть он уже или нет, и так обойти работу с несколькими вкладками(каждую в отдельности обрабатывать)


многие списки не реверсятся(отображаются не в правильной последовательности
если в комментах написать <div> или что егодно с <> то эти сомволы заменятся(так и должно быть) но отображаться будет теми символами которых их заменили из за тега <pre> мб конвертить их обратно
листать фотки(что то типо кнопков слева вправо)
при открытии картинки справа не пишется количество комментов
в шапке этого блока всегда линк на сообщение(то которое новое , и если оно уже открыто то линк не меняется, и если пришло еще 1 сообщение и это открыто то линк на новое)
при получении сообщения делать пуш уведомление которое откроет справа диалог в маленьком окошке
интерфейсы продумать и добавить
+ Получилось очень криво, мб придумать другой способ(хорошо бы оставить так но сделать инлайн с картинками из альбома но хз как так сделать)загрузка картинок в кльбом сделать так же как и добавление альбома

блок для добавления новости в News и на стене пользователя вынести в хелпер?
при отправке сообщений комментов и тдтд надо очищать поле для ввода
//перенос строки в комментах не работает
при отправке комментов не обновляется их количество на кнопке отображения
//при открывании на стене фотки справа заблокированы лайки и тд(так и должно быть, это правильно) но остается поле для ввода комментария, его надо убрать
//@helper Author(ApplicationUser user,Group group,DateTime date) добавил картинку на стену записью кликнул по ней
record AddComment  надо проверять можно ли комментить
DeleteRecordInside  и record->DeleteInside закомментил
//можно сделать загрузку на сервер файла json для сервер инфо просто текст читать из него в js как в проекте tpr3 и можно будет как будто файл загружать

//JS сервер инфо при создании статьи сразу туда прописывать хештеги по названием секций в которые вложена статья
место где диалоги и отображение сообщений держится через signalr и сессии скорее всего будет плохо работать если в разных вкладках открыть разные страницы
валидация проверить отображаются ли ошибки

ФУНКЦИИ ОСТАЛОСЬ ИДЕИ

удалять записи со стены

все поля скрывать (типо блока с добавлением фотки на страницу юзера, или для добавления записи на стену
репост
полная реализация комментов
//текстовые комменты
в сообщениях контент
//добавление альбомов
удалять картинки

+вроде удалять друзей
удалять диалоги
удалять альбомы
везде уровень доступа проверять

при загрузке в альбом не добавлять на стену?
+вроде при переходе на страницу альбомов группы проверять нужно ли отобразать поле для добавления как картинок так и альбомов
+вроде для пользователя тоже самое
блоки контента опять слишком уезжают вниз


если фотка добавляется в закрытый альбом то не стену не добавлять
уровень доступа везде продумать и сделать

--- 
кудато добавил фотку в 1 или 2 альбом она появилась на стене и все, по ней не кликается и в альбомах нет




GetPartialList   сейчас добавлена реализация параметров но надо их передавать в местах где это требуется по коду и логике
GetPartialList1   убрать 1 и добавить параметры там где надо(там где нет дозагрузки методами)  FunctionsProject


//кнопку для подъема наверх
диалоги надо как то сортировать по дате ласт сообщения перед отправкой
ТЕНИ ДОБАВИТЬ
ApplicationUser сделать partial class?? и вынести методы
//DeleteFriend надо как то объеденить с follow и вынести из контроллера
+вроде   в identymodels {
+вроде вынести в обобщенную(без обобщения тк внитри это не используется) функцию и везде где дозагрузка юзать это
 start = start > 0 ? start - 1 : 0;
            
res.AddRange((List<Record>)GetPartialList<Record>(this.WallRecord, start, count));

}
контроллер почистить
оптимизация кода
методы посокращать, сейчас некоторые дублируются или частично дублируются
формы отправки засунуть как то в функцию шаблонную
потестить дозагрузку мемов
//LoadDataForShort для юзера и группы скорее всего в методе альбома уже есть штука для получения и загрузки картинки и тд испоьзовать ее
Friends и второй список попробовать объеденить
в списке друзей не отображается фотка
FollowPerson  и DeleteFriend  вынести в 1 функцию или типо того и метод DeleteFriend это для того что бы удалить прямо в списке
FollowGroup в контроллере сейчас работает не правильно и добавить список не одобренных пользователей в группу лдя закрытых групп
добавление в друзья OnComplete_add_friend is not defined   сейчас просто закомментил в форме FollowUserPartial тут должен быть запрос к хабу на отображение числа слева в меню


//при отправке сообщения слева не обновляется число, но туда загрузилось какое то представление(даже не частичное)


//ApplicationUserShort выносить из контекста
метод лоад обобщенный принимает объект и строку с именем того что загрузить там код типо{
domain интерфейс сделать и этот метод вынести в класс database

 using (ApplicationDbContext db = new ApplicationDbContext())
            {
                db.Set<ApplicationUser>().Attach(user);
                if (!db.Entry(user).Collection(x1 => x1.Followers).IsLoaded)
                    db.Entry(user).Collection(x1 => x1.Followers).Load();
            }



}
+вроде context.Entry(user).State = EntityState.Modified;   поменять на   context.Set<User>().Attach(user);

AsNoTracking подумать куда можно засунуть и засунуть
//в хедере блок справа двигается если экран меньше 960px
добавление главное секции перенести в appdbinitializer
при регистрации и широком экране "фамилия " сползает
+вроде  реснул проект, само прошло????? после отправки сообщения отрисовываются 2 а не 1
блоки(тонкий точно) опять уезжает слишком низко
страница группы стену "разворачивать"
+вроде reverse поменять везде
+вроде UserListToShort не положительные числа переписать
методы по добавлению чего либо выносить в dataBase
+вроде Messages-- загружает все диалоги, сейчас без структуры для дозагрузки
Chat image не реализована даже связь

вынести загрузку данных в отдельные методы
все аналогичные штуки переписать под 1 метод принимающий делегат if (!db.Entry(group).Collection(x1 => x1.Albums).IsLoaded)

разделение на контроллер для групп и для пользователей???

GetAlbums для identy и group вынести в обобщенный метод в альбомы

//CanAddFriend follow и тд переписать bool под число\тип тк 3 варианта не хватит, есть еще и не залогиневшийся
//добавление в друзья тестить
//FollowPerson тут проверять есть ли он в фоловерах и если есть переносить в друзья



все формы в которых есть текст переписать под ajax формы и  декодировать текст как в info ---convert_string(str) {
//перед отправкой сообщения декодировать текст как в info
//у каждого блока сообшения надо id задавать с id сообщения и при получении сообщений смотреть если ли там строчное представление id и если нет то проверять на строку id диалога и если и его нет то это вернулось число

 + это пофиксило if (block_s_1_c.bottom < (document.documentElement.clientHeight-100))   обавил -100 и для другого тоже посомтрть что бы слишком вниз не уезжало

//в 1 из методов отправлять номер сесии до обращением за html

//в chat.client.NeedDownloadChangesMessages надо определить что загружать диалог , колличество или диалоги сокращенные

//функцию в ajax форм js по отображению и сокрытию прелоадера вынести и в главный файл
//получает->отправляет-> там проверяется если ЛИ ДЛЯ АВТОРА непрочитанное сообщение и если есть то отправляется всей группе
//подумать как разделить что бы в чате сообщения загружались а так просто отображалось тпио +1 новое сообщение
//отображение списка сообщений вынести в частичное
//LoadNewMessages тоже прикрутить к частичному
//поотправлять сообщения



//доделать возможность открывать картинки хотя бы криво
//отрисовывать там автора хотя бы если есть record привязанный
//в конце странице в лаяуте после рендербоди сделать див и если он "в экране" то блоки с контентом не двигать 
везде где блоки контента с транзишном надо делать внутренний блок с транзишном 0 тк при загрузке странице все еще секунду едет
+вроде сейчас есть баг при скролле, если листать далеко вниз медленно то страница удлинняется
//при скроле сделать что бы далеко не уезжало

иногда создается лишний диалог как и почему хз
{
СЕССИИ всю дозагрузку оргинизовать черех них....
хранить словом название метода основного откуда юзер пришел типо --Dialog
+ 2 поле это номер на котором загрузка остановилась 
+3 поле колличество которое надо загрузить
при переходе на основной метод где в частичном встроенном понадобится сессия обновлять поля
Session["name"] = "Tom";
var val = Session["name"];

}



//при загрузке страниц отправлять ajax запрос на присоединение к хабам(в обычный контроллер)

signalr
https://metanit.com/sharp/mvc5/16.2.php
https://msdn.microsoft.com/ru-ru/magazine/dn802609.aspx
https://docs.microsoft.com/ru-ru/aspnet/signalr/overview/guide-to-the-api/working-with-groups
https://docs.microsoft.com/ru-ru/aspnet/signalr/overview/guide-to-the-api/working-with-groups

[assembly: OwinStartup(typeof(server_info_web_desk.Models.Startup))]

//хранить лист с хабами
//при логине засовывать юзера в хаб
//формировать хаб при отправки сообщений

в message поменять Meme на record?????????????


Dialog  //TODO УРОВЕНЬ ДОСТУПА
CountNewMessage не реализовано Messages
отображение чатов вынести в отдельное парциал представление и тоже дозагружать
для чата добавить кратинку
LastMessageDate убрать тк там есть сообщение с датой
комменты

//signalR почитать посомтреть что как мб сделать или продумать хотя бы


//ХЗЗЗЗЗЗЗЗЗЗЗЗ DISPOSE

LoadShowImageRecord   проверять доступ   + загружать соседние + в хелпере их еще дорисовывать стрелки
при клике на альбом на странице альбомов, выделять его
//засунуть куда нибудь форму для загрузки изображений в альбом выделенный



ImageForRecordSize2 healpers сюда в правый блок еще и картинку владельца с линком и тд
//добавить дату регистрации юзера и группы если нет
//при добавлении авы плохо отображается на стене(без линка на человека)
//и туда же в новостях вообще ошибка отображения мема появляется
сделать отображение записи картинки для альбома и тд отдельным методом

вынести в интерфейс методы группы и страницы пользователя
AlbumsPerson+AlbumsGroup+LoadImagesAlbum проверять доступ+защита

потестить инфо тк там могут быть ошибки особенно с SectionParrentId Section_ParrentId
UserListToShort переделать под только положительные числа

для страницы записей группы и юзера не загружать мемы!!!!!!!!!!!!
дата при редактировании юзера\группы не отображается



+проверить добавление в друзья(partial)+ сейчас  точно нормально не работает код добавления мб его нет
уровень доступа для лайка и репоста проверять
+убирать кнопку лайков и репостов для не авторизованных пользователей
//мемы граппа не отображаются кратинки
мемы добавление группа проверить добавляются ли в новости подписчиков
WallRecord вынести тоже
//загрузку картинки для альбома вынести в метод в альбоме и поменять по коду
добавить "public id" общую таблицу для групп и пользователей
//Groups метод список групп закомментил тк там ошибка и вынести его

инициализация бд происходит в ассинхронном режиме и не успеват создаваться?????7
если не залогиневшить переходить на страницу пользователя то просто 404 и все, до метода контроллера не доходит
PersonalRecord разрешить доступ к этой страницы только если в строке запроса указан id
при регистрации заставлять вводить некоторые основные данные(день рождения имя фамилия и тд)
при редактировании страницы запретить удалять обязательные свойтсва(должно оставаться хоть что то)
доделать хелпер record который для лайков там и тд спецсомволы(сердце и тд) взять с сайта
не все ссылки делать черными или как то выделять их
в record сейчас список репостнувших людей и список созданных записей по этой записи(тоже самое+ группы) надо совместить или понять зачем 2 списка
неполностью картинки влезают в мемы и тдтд как то задавать размеры(высоту) в зависимости от картинки??


PersonalRecord  и GroupRecord обрабатывать приватные страницы 
ссылки в группе типо пользователей сделать через ajax?????
остановился 
Image нужная ajax ссылка в хелперах
ImageSmall нужная ajax ссылка в хелперах
MemeRecord сделать в хелперах и отдельно вынести из него Meme для сообщений и тдтд
класс хелперов разделить на разные классы
сделать мем зависимым от записи??? и связь правильная 1 к 1 будет
PersonalRecord проверять если ли доступ к альбомам
PersonalRecord колличество всего сейчас не указывается
skip take не будет скорее всего работать без сортировки

при создании группы добавлять 2 альбома как и для юзера
при добавлении авы добавлять ее в альбом для авы и альбом номер 2
фотки которые юзер на стену выкладывает показывать только их в блоке для фото и все что со стены туда 

создавать альбом при регистрации и запретить его удалять это для аватарок
продумать и мб переписать то что сейчас есть под записи для мемов и картинок(есть запись которая ссылается на картинку или мем и при репосте создатся новая в записи лайки репосты и тд)
+конструкторы есть не у всех моделей даже базовые
атрибуты лучше продумать и добавить где надо
картинки оборачивать в мемы все таки
при добавлении первой аватарки или фотки на стену или просто фотки создавать альбом для этого и распределять фотки уже по альбомам
связь моделей сделать через эту штуку тк сейчас не будет нормально связывать https://metanit.com/sharp/mvc5/5.9.php


//meme -> public ICollection<Message> Messages { get; set; } лишнее?
убрать "ответную связь" там где мне не нужно будет находить что либо(public ICollection<Chat> ChatsCreated { get; set; })



аватарки просто брать из альбома для аватарок








server_info_web_desk.Models.Interfaces.IImage
вынести текущий класс в папку для info сделать класс image для sociel и свойства вынести в интерфейсы



//в  mass_parrent = []; не все секции которые надо открыть а только их родители которые могут повторяться с открытыми


//идти по массиву открытых секций и отрисовывать всех их родителей но смотреть по тому же списку нужно ли их открывать
//load_left_block дописать

насколько понял не получится для секций добавить каскадное удаление в бд при инициализации бд делать sql запрос на бновление бд

менять url при клике на секцию и статьи

загрузку данных на сервер сделать файлом и хранить в нем байты? с форматом .dat
//проверить поиск как работает везде
//возможно не откроется загруженная через поиск статья проверить
кнопка перезагрузки менб слева(не с сервера)
флаг "отпрытия" для каждой секции

//Section_parrentId везде где добавляется проверять есть ли доступ   427 строка
//db.Sections.FirstOrDefault(x1 => x1.Id == i.Section_parrentId && x1.UserId == check_id) != null
 //if (i.Section_parrentId ==0||   тут еще вложенное условие делать


убрать жесткую связь и зависимость  https://metanit.com/sharp/mvc5/21.2.php
//проверить как загружается в бд данные
//мб+  данные которые загружаются на серв из файла надо проверять(например parren_sec_id что бы это пользователя была)
добавить интерфейсы для всех классов domain
вынести бизнесс логику в классы
вынести свойство id в интерфейс idomain
метод из класса функций который CheckAccessSection перенести в модель репозитория и разделить его до просмотря и для редактирования секции, мб сделать еще и для статьи
добавить репозиторий


поиск приоритет на выбранный раздел
//за вхождение в header или теги все ниже *1 ,в body-0.7 
//1 первая часть слова- приоритет 0.5

спецсомволы
#-по хештегу
()-главное слово
+-слова рядом



при поиске не все загружать а только часть и потом дозагружать остальное если надо


больше проверок Upload_data_file_text(string upload_text)

сейчас полностью очень плохо сервер работает с получением данных из файла если данные были изменены на десктоп версии(есть базовые проверки но не обрабатываются например добавленные секции и тд)
//места где JSON.parse(data.responseText); то это эти функции вызывает переписать под ajax из js
//оставшиеся формы в js засунуть
//прелоадер разместить там где надо
//валидация перед загрузкой на сервер(вынести из форм?)
//те формы которые есть все вынести в js и загружать в хтмл перед отправкой, и потом убирать
//отправку форму сделать из js а не по сабмиту, и менять символы <> на стороне клиента перед отправкой
//+-  сделать ее до отправки на сервер-- конверт стринг функцию убрать? или если делать то что сверху посмотреть где применяется, много где не должна
//добавить прелоадер к ajax загрузкам
//места где определяется ли доступ к той или иной информации мб вынетс по функциям + уже есть CheckAccessSection

Upload_data_file_text намного лучше обработку ошибок, данные не удалять сразу а удалять только после того как все остальные этапы успешно завершены

при добавлении чего либо менять порядок
вынести бизнес логику из контроллера

//сам поиск, форма поиска

{
это перписать тогда Upload_data_file_text
может id задавать отрицательные?? и менять их
при создании секции\статьи на десктоп версии id= null
при добавлении вложенных секций в те у который id==null хз что делать


}
bd
добавить до 10 картинок к статье
придумать способ задавать и обрабатывать порядок секций статей что бы пользователь мог менять их

//send_form в trycath обернуть


//OnComplete_delete_section и OnComplete_delete_article   надо еще данные из массивов удалять и проверять если удалялась главная секция то удалять только ее инсайд
//Delete_article сейчас не реализовано--- проверить
из конроллера лишние данные не передавать юзать анонимный тип только для того что нужно





//перенос строки смотреть как работает и мб его сдалать тоже заменой


????вынести db в using db

сейчас в js много где основная секция находится как 1  в массиве mass_section[0].Id


//строка 310  maininfoscripts  остановился на добавлении секций и статей


банндлы применить отредактировать  https://metanit.com/sharp/mvc5/13.1.php

вспомнить провалидацию и валидацию на сервере if (ModelState.IsValid)
@Html.ValidationMessageFor(model => model.UserName)
@Html.ValidationSummary(true)
    
//посомтреть как хранятся данные у которых я поменял <> на те самые символы и может еще до сохранения и отправки на сервер менять на символы
//создание 1 секции при регистрации юзера https://metanit.com/sharp/mvc5/12.14.php
разрешить доступ к некоторым секциям
сделать пароль для секций
возможность скопировать секцию/статью себе
при загрузке секции/ статьи изменять url


?из click_name_section взять изменение before
с функциями разобраться их очень много все похожи легко запутаться

js
index_info_scripts- сюда основные скрипты которые и на индексе должны работать

действия если пароль забыт

//При клике загружать статью если боди нул или андеы
при каждом открывании закрывании секции менять высоту div_for_block_id

//проверить как удаляется


добавить поле "порядка" в секции и статьи
ТО ЧТО ПЛАНИРУЮ СДЕЛАТЬ , СДЕЛАТЬ ОТДЕЛЬНЫМ ПРОЕКТОМ
проверять загруженный текст что бы там не было запрещенных слов (drop table и все такое)
Load_all_data_in_db---- не удалять сразу а перед этим парсить показывать данные и спрашивать сохранить ли это

Index--- короткое введение и кнопки начать работу продолжить работу и тд сообщение от пользователя чей index
добавить кнопку "продолжить" и открывать открытые ранее секции на серве и мб в js тоже


загружать файл не загрузкой файла а читать его в js и отправлять формой
при загрузке чего либо с сервера проверять есть ли уже в оперативке
при поиске показывать не все записи и потом их дозагружать
из байтов в текст https://msdn.microsoft.com/ru-ru/library/744y86tc(v=vs.110).aspx
для загрузки файла на серв https://metanit.com/sharp/articles/26.php

в переписанный под c# #serverinfo сделать кнопку для скачки файла всего(всех данных json) и загрузки?
возможность прикреплять картинки
смотреть чужое
сообщения?
связи реализовать правильно
много контроллеров?
валидация
правильное отображение и редактирование через атрибуты
возможность скачать как файл так и офлайн версию
кнопка которая закрывает все вкладки должны закрывать все вкладки в выделенной вкладке
преводить запрос и весь текст к стандартному виду(как в питоне) и уже норм искать

из оффлайн версии
#serverinfo переписать под оффлайн версию с сохранением файла и загрузкой, сделать флаг и при загрузке с сервера его устанавливать и если установлен то онлайн версия иначе офлайн


старый serverinfo
serverinfo при добавлении статьи без назвения оно высотой 1px и открыть ее можно только через консоль
удалять отправленные данные только при успешном ответе сервера #serverinfo
Сделать туториал по запуску серверинфо
ошибка не выделив секцию начал поиск и потом поменял слово и нажал поиск опять, выделилась последняя секция

//в индекс id юзера передавать чбю дб открывать


